<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2219px" preserveAspectRatio="none" style="width:2649px;height:2219px;background:#FFFFFF;" version="1.1" viewBox="0 0 2649 2219" width="2649px" zoomAndPan="magnify"><title>Smart-Monitor (Lab) &#8212; Closed-Loop Self-Healing Flow</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="424.5801" x="1113.6362" y="27.9951">Smart-Monitor (Lab) &#8212; Closed-Loop Self-Healing Flow</text><g><title>Classifier Engine</title><rect fill="#FFFFFF" height="174.9297" style="stroke:#181818;stroke-width:1;" width="10" x="1173.2549" y="531.2813"/></g><g><title>Policy . Safety Layer</title><rect fill="#FFFFFF" height="215.8672" style="stroke:#181818;stroke-width:1;" width="10" x="1622.4043" y="750.4766"/></g><g><title>Remediator</title><rect fill="#FFFFFF" height="368.7266" style="stroke:#181818;stroke-width:1;" width="10" x="1861.2979" y="1011.6094"/></g><rect fill="none" height="120.4688" style="stroke:#000000;stroke-width:1.5;" width="1258.543" x="498.3159" y="838.875"/><rect fill="none" height="458.9297" style="stroke:#000000;stroke-width:1.5;" width="2632.8525" x="10" y="973.3438"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="1948.5796" x="20" y="1026.6094"/><rect fill="none" height="148.7969" style="stroke:#000000;stroke-width:1.5;" width="2275.0142" x="357.8384" y="1145.1406"/><rect fill="none" height="90.5313" style="stroke:#000000;stroke-width:1.5;" width="1989.6089" x="498.3159" y="1446.2734"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="1989.6089" x="498.3159" y="1550.8047"/><rect fill="none" height="175.7969" style="stroke:#000000;stroke-width:1.5;" width="1989.6089" x="498.3159" y="1777.8672"/><g><title>Orchestrator.Agent</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="110.9775" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="114" x2="114" y1="134.8906" y2="2122.5938"/></g><g><title>systemd .D-Bus.</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="429.0771" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="432.8384" x2="432.8384" y1="134.8906" y2="2122.5938"/></g><g><title>Flask API .Gunicorn.</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="581.9517" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="585.3159" x2="585.3159" y1="134.8906" y2="2122.5938"/></g><g><title>PostgreSQL</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="875.4795" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="878.5298" x2="878.5298" y1="134.8906" y2="2122.5938"/></g><g><title>Classifier Engine</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="1174.2549" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1177.6338" x2="1177.6338" y1="134.8906" y2="2122.5938"/></g><g><title>Policy . Safety Layer</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="1623.4043" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1626.9497" x2="1626.9497" y1="134.8906" y2="2122.5938"/></g><g><title>Remediator</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="1862.2979" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1866.0161" x2="1866.0161" y1="134.8906" y2="2122.5938"/></g><g><title>Nginx .TLS.SSE.</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="2055.0098" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2058.832" x2="2058.832" y1="134.8906" y2="2122.5938"/></g><g><title>Cloudflared .opt.</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="2220.9307" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2224.0908" x2="2224.0908" y1="134.8906" y2="2122.5938"/></g><g><title>Engineer Browser</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="2409.0049" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2412.085" x2="2412.085" y1="134.8906" y2="2122.5938"/></g><g><title>Host Helper .opt.</title><rect fill="#000000" fill-opacity="0.00000" height="1987.7031" width="8" x="2551.3887" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2554.9248" x2="2554.9248" y1="134.8906" y2="2122.5938"/></g><g class="participant participant-head" data-participant="AG"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.9551" x="30" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.0439" x="47.4556" y="107.292">Orchestrator/Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.9551" x="37" y="123.5889">&#171;sm-orchestrator-lab&#187;</text></g><g class="participant participant-tail" data-participant="AG"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.9551" x="30" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.0439" x="47.4556" y="2141.5889">Orchestrator/Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.9551" x="37" y="2157.8857">&#171;sm-orchestrator-lab&#187;</text></g><g class="participant participant-head" data-participant="SYS"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.4775" x="367.8384" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.4775" x="374.8384" y="107.292">systemd (D-Bus)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.043" x="381.0557" y="123.5889">/mnt /run/dbus</text></g><g class="participant participant-tail" data-participant="SYS"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.4775" x="367.8384" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.4775" x="374.8384" y="2141.5889">systemd (D-Bus)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.043" x="381.0557" y="2157.8857">/mnt /run/dbus</text></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155.2715" x="508.3159" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141.2715" x="515.3159" y="107.292">Flask API (Gunicorn)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.7637" x="553.5698" y="123.5889">&#171;sm-gui&#187;</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155.2715" x="508.3159" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141.2715" x="515.3159" y="2141.5889">Flask API (Gunicorn)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.7637" x="553.5698" y="2157.8857">&#171;sm-gui&#187;</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117.8994" x="820.5298" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="839.103" y="107.292">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.8994" x="827.5298" y="123.5889">&#171;sm-postgres&#187;</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117.8994" x="820.5298" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="839.103" y="2141.5889">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.8994" x="827.5298" y="2157.8857">&#171;sm-postgres&#187;</text></g><g class="participant participant-head" data-participant="CLF"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.2422" x="1096.6338" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.3408" x="1120.0845" y="107.292">Classifier Engine</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.2422" x="1103.6338" y="123.5889">(heuristics/baselines)</text></g><g class="participant participant-tail" data-participant="CLF"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.2422" x="1096.6338" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.3408" x="1120.0845" y="2141.5889">Classifier Engine</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.2422" x="1103.6338" y="2157.8857">(heuristics/baselines)</text></g><g class="participant participant-head" data-participant="POL"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="238.9092" x="1507.9497" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.8525" x="1552.978" y="107.292">Policy &amp; Safety Layer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224.9092" x="1514.9497" y="123.5889">(allow-list, cooldowns, windows)</text></g><g class="participant participant-tail" data-participant="POL"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="238.9092" x="1507.9497" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.8525" x="1552.978" y="2141.5889">Policy &amp; Safety Layer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224.9092" x="1514.9497" y="2157.8857">(allow-list, cooldowns, windows)</text></g><g class="participant participant-head" data-participant="ACT"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184.5635" x="1774.0161" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.7578" x="1825.4189" y="107.292">Remediator</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.5635" x="1781.0161" y="123.5889">(actions, backoff, verify)</text></g><g class="participant participant-tail" data-participant="ACT"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184.5635" x="1774.0161" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.7578" x="1825.4189" y="2141.5889">Remediator</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.5635" x="1781.0161" y="2157.8857">(actions, backoff, verify)</text></g><g class="participant participant-head" data-participant="NGINX"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.3555" x="1995.832" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.3555" x="2002.832" y="107.292">Nginx (TLS/SSE)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.9219" x="2018.0488" y="123.5889">&#171;sm-nginx&#187;</text></g><g class="participant participant-tail" data-participant="NGINX"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.3555" x="1995.832" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.3555" x="2002.832" y="2141.5889">Nginx (TLS/SSE)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.9219" x="2018.0488" y="2157.8857">&#171;sm-nginx&#187;</text></g><g class="participant participant-head" data-participant="CF"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135.6797" x="2157.0908" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.959" x="2165.4512" y="107.292">Cloudflared (opt)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.6797" x="2164.0908" y="123.5889">&#171;sm-cloudflared&#187;</text></g><g class="participant participant-tail" data-participant="CF"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135.6797" x="2157.0908" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.959" x="2165.4512" y="2141.5889">Cloudflared (opt)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.6797" x="2164.0908" y="2157.8857">&#171;sm-cloudflared&#187;</text></g><g class="participant participant-head" data-participant="UI"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.8398" x="2348.085" y="115.292">Engineer Browser</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.2998" x="2351.855" y="131.5889">(SSE dashboard)</text><ellipse cx="2413.0049" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M2413.0049,58.7969 L2413.0049,85.7969 M2400.0049,66.7969 L2426.0049,66.7969 M2413.0049,85.7969 L2400.0049,100.7969 M2413.0049,85.7969 L2426.0049,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="UI"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.8398" x="2348.085" y="2134.5889">Engineer Browser</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.2998" x="2351.855" y="2150.8857">(SSE dashboard)</text><ellipse cx="2413.0049" cy="2162.6875" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M2413.0049,2170.6875 L2413.0049,2197.6875 M2400.0049,2178.6875 L2426.0049,2178.6875 M2413.0049,2197.6875 L2400.0049,2212.6875 M2413.0049,2197.6875 L2426.0049,2212.6875" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="HH"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.9277" x="2487.9248" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.9277" x="2494.9248" y="107.292">Host Helper (opt)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.8438" x="2511.9668" y="123.5889">root-priv API</text></g><g class="participant participant-tail" data-participant="HH"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.9277" x="2487.9248" y="2121.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.9277" x="2494.9248" y="2141.5889">Host Helper (opt)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.8438" x="2511.9668" y="2157.8857">root-priv API</text></g><g><title>Classifier Engine</title><rect fill="#FFFFFF" height="174.9297" style="stroke:#181818;stroke-width:1;" width="10" x="1173.2549" y="531.2813"/></g><g><title>Policy . Safety Layer</title><rect fill="#FFFFFF" height="215.8672" style="stroke:#181818;stroke-width:1;" width="10" x="1622.4043" y="750.4766"/></g><g><title>Remediator</title><rect fill="#FFFFFF" height="368.7266" style="stroke:#181818;stroke-width:1;" width="10" x="1861.2979" y="1011.6094"/></g><polygon fill="#FEFFDD" points="52,149.8906,2474,149.8906,2484,198.8906,2474,247.8906,52,247.8906,42,198.8906,52,149.8906" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.5742" x="1119.6753" y="165.9575">Smart-Monitor LAB stack (docker-compose):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.6328" x="1119.6753" y="181.0903">- sm-orchestrator-lab (privileged)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.6143" x="1119.6753" y="196.2231">- sm-gui (Flask/Gunicorn API)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.9253" x="1119.6753" y="211.356">- sm-postgres (state + audit)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.5728" x="1119.6753" y="226.4888">- sm-nginx (TLS + SSE)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8657" x="1119.6753" y="241.6216">- sm-cloudflared (optional)</text><g class="message" data-participant-1="AG" data-participant-2="SYS"><polygon fill="#181818" points="421.0771,301.0859,431.0771,305.0859,421.0771,309.0859,425.0771,305.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="114.9775" x2="427.0771" y1="305.0859" y2="305.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.2114" x="121.9775" y="269.7544">Query service states via D-Bus</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.0996" x="121.9775" y="284.8872">(is-active, show SubState/Type/UnitFileState)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.4731" x="121.9775" y="300.02">+ read /proc,/sys (CPU, mem, disk IO)</text></g><path d="M119,318.0859 L119,343.0859 L725,343.0859 L725,328.0859 L715,318.0859 L119,318.0859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M715,318.0859 L715,328.0859 L725,328.0859 L715,318.0859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585.3364" x="125" y="335.1528">Normalize raw states &#8594; {running|stopped|failed|unknown}\nBuild metrics &amp; events batch</text><g class="message" data-participant-1="AG" data-participant-2="API"><polygon fill="#181818" points="573.9517,395.6172,583.9517,399.6172,573.9517,403.6172,577.9517,399.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="114.9775" x2="579.9517" y1="399.6172" y2="399.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.541" x="121.9775" y="364.2856">POST /api/ingest/service-status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.8462" x="121.9775" y="379.4185">&amp; /api/ingest/metrics</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.9297" x="121.9775" y="394.5513">(payload: host, svc, raw, normalized, ts, dims)</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="867.4795,439.8828,877.4795,443.8828,867.4795,447.8828,871.4795,443.8828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="873.4795" y1="443.8828" y2="443.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.7808" x="592.9517" y="423.6841">INSERT metrics/events rows</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.5278" x="592.9517" y="438.8169">(services, processes, disks, net, smartctl)</text></g><g class="message" data-participant-1="DB" data-participant-2="API"><polygon fill="#181818" points="596.9517,469.0156,586.9517,473.0156,596.9517,477.0156,592.9517,473.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="590.9517" x2="878.4795" y1="473.0156" y2="473.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6421" x="602.9517" y="467.9497">ack</text></g><g class="message" data-participant-1="API" data-participant-2="AG"><polygon fill="#181818" points="125.9775,498.1484,115.9775,502.1484,125.9775,506.1484,121.9775,502.1484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="119.9775" x2="584.9517" y1="502.1484" y2="502.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.7305" x="131.9775" y="497.0825">202 Accepted</text></g><g class="message" data-participant-1="API" data-participant-2="CLF"><polygon fill="#181818" points="1161.2549,527.2813,1171.2549,531.2813,1161.2549,535.2813,1165.2549,531.2813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="1167.2549" y1="531.2813" y2="531.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.8379" x="592.9517" y="526.2153">notifyNewBatch(events)</text></g><g class="message" data-participant-1="CLF" data-participant-2="DB"><polygon fill="#181818" points="890.4795,556.4141,880.4795,560.4141,890.4795,564.4141,886.4795,560.4141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="884.4795" x2="1172.2549" y1="560.4141" y2="560.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.334" x="896.4795" y="555.3481">Read recent window (&#916;t) for correlation</text></g><g class="message" data-participant-1="DB" data-participant-2="CLF"><polygon fill="#181818" points="1161.2549,585.5469,1171.2549,589.5469,1161.2549,593.5469,1165.2549,589.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="879.4795" x2="1167.2549" y1="589.5469" y2="589.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.438" x="886.4795" y="584.481">timeseries + service history</text></g><g class="message" data-participant-1="CLF" data-participant-2="CLF"><line style="stroke:#181818;stroke-width:1;" x1="1183.2549" x2="1225.2549" y1="664.0781" y2="664.0781"/><line style="stroke:#181818;stroke-width:1;" x1="1225.2549" x2="1225.2549" y1="664.0781" y2="677.0781"/><line style="stroke:#181818;stroke-width:1;" x1="1184.2549" x2="1225.2549" y1="677.0781" y2="677.0781"/><polygon fill="#181818" points="1194.2549,673.0781,1184.2549,677.0781,1194.2549,681.0781,1190.2549,677.0781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.8389" x="1190.2549" y="613.6138">Heuristics + baselines + state machine</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.8057" x="1190.2549" y="628.7466">&#8226; failed + retry_exceeded &#8594; INCIDENT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.1494" x="1190.2549" y="643.8794">&#8226; CPU z-score&gt;k + OOM + service down &#8594; MEMORY_PRESSURE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.8594" x="1190.2549" y="659.0122">&#8226; flapping(rate) &gt; threshold &#8594; FLAPPING</text></g><g class="message" data-participant-1="CLF" data-participant-2="DB"><polygon fill="#181818" points="890.4795,702.2109,880.4795,706.2109,890.4795,710.2109,886.4795,706.2109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="884.4795" x2="1177.2549" y1="706.2109" y2="706.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.7754" x="896.4795" y="701.145">INSERT classifications(labels, confidence)</text></g><g class="message" data-participant-1="API" data-participant-2="POL"><polygon fill="#181818" points="1610.4043,746.4766,1620.4043,750.4766,1610.4043,754.4766,1614.4043,750.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="1616.4043" y1="750.4766" y2="750.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.6909" x="592.9517" y="730.2778">evaluate(decisionRequest)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.1094" x="592.9517" y="745.4106">(labels, service, host, cooldown, window)</text></g><g class="message" data-participant-1="POL" data-participant-2="DB"><polygon fill="#181818" points="890.4795,790.7422,880.4795,794.7422,890.4795,798.7422,886.4795,794.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="884.4795" x2="1621.4043" y1="794.7422" y2="794.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.8447" x="896.4795" y="774.5435">read policy (approved_services.json snapshot) &amp; cooldowns</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.001" x="896.4795" y="789.6763">+ last actions for this svc</text></g><g class="message" data-participant-1="DB" data-participant-2="POL"><polygon fill="#181818" points="1610.4043,819.875,1620.4043,823.875,1610.4043,827.875,1614.4043,823.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="879.4795" x2="1616.4043" y1="823.875" y2="823.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.106" x="886.4795" y="818.8091">policy rows</text></g><path d="M498.3159,838.875 L562.7588,838.875 L562.7588,846.0078 L552.7588,856.0078 L498.3159,856.0078 L498.3159,838.875" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="120.4688" style="stroke:#000000;stroke-width:1.5;" width="1258.543" x="498.3159" y="838.875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="513.3159" y="851.9419">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="118.5293" x="577.7588" y="851.0854">[Allowed by policy]</text><g class="message" data-participant-1="POL" data-participant-2="API"><polygon fill="#181818" points="596.9517,888.2734,586.9517,892.2734,596.9517,896.2734,592.9517,892.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="590.9517" x2="1621.4043" y1="892.2734" y2="892.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.3892" x="602.9517" y="872.0747">APPROVED(actionSpec, guardrails)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.3252" x="602.9517" y="887.2075">(max_retries, backoff, timeout)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="498.3159" x2="1756.8589" y1="901.2734" y2="901.2734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="124.647" x="503.3159" y="911.4839">[Denied or Dry-Run]</text><g class="message" data-participant-1="POL" data-participant-2="API"><polygon fill="#181818" points="596.9517,947.3438,586.9517,951.3438,596.9517,955.3438,592.9517,951.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="590.9517" x2="1621.4043" y1="951.3438" y2="951.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.7446" x="602.9517" y="931.145">DENIED(reason) or DRY_RUN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.5913" x="602.9517" y="946.2778">(log only)</text></g><path d="M10,973.3438 L74.4429,973.3438 L74.4429,980.4766 L64.4429,990.4766 L10,990.4766 L10,973.3438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="458.9297" style="stroke:#000000;stroke-width:1.5;" width="2632.8525" x="10" y="973.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="986.4106">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77.6714" x="89.4429" y="985.5542">[APPROVED]</text><g class="message" data-participant-1="API" data-participant-2="ACT"><polygon fill="#181818" points="1849.2979,1007.6094,1859.2979,1011.6094,1849.2979,1015.6094,1853.2979,1011.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="1855.2979" y1="1011.6094" y2="1011.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.98" x="592.9517" y="1006.5435">execute(actionSpec)</text></g><path d="M20,1026.6094 L89.4512,1026.6094 L89.4512,1033.7422 L79.4512,1043.7422 L20,1043.7422 L20,1026.6094" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="1948.5796" x="20" y="1026.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4512" x="35" y="1039.6763">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="251.6465" x="104.4512" y="1038.8198">[Lab (privileged agent executes locally)]</text><g class="message" data-participant-1="ACT" data-participant-2="AG"><polygon fill="#181818" points="125.9775,1060.875,115.9775,1064.875,125.9775,1068.875,121.9775,1064.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="119.9775" x2="1860.2979" y1="1064.875" y2="1064.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.8374" x="131.9775" y="1059.8091">requestRemediation(service:restart)</text></g><g class="message" data-participant-1="AG" data-participant-2="SYS"><polygon fill="#181818" points="421.0771,1090.0078,431.0771,1094.0078,421.0771,1098.0078,425.0771,1094.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="114.9775" x2="427.0771" y1="1094.0078" y2="1094.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.1392" x="121.9775" y="1088.9419">systemctl restart &lt;svc&gt;</text></g><g class="message" data-participant-1="SYS" data-participant-2="AG"><polygon fill="#181818" points="125.9775,1119.1406,115.9775,1123.1406,125.9775,1127.1406,121.9775,1123.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="119.9775" x2="432.0771" y1="1123.1406" y2="1123.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.5098" x="131.9775" y="1118.0747">result(exit code, SubState)</text></g><path d="M357.8384,1145.1406 L427.2896,1145.1406 L427.2896,1152.2734 L417.2896,1162.2734 L357.8384,1162.2734 L357.8384,1145.1406" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="148.7969" style="stroke:#000000;stroke-width:1.5;" width="2275.0142" x="357.8384" y="1145.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4512" x="372.8384" y="1158.2075">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="210.2085" x="442.2896" y="1157.3511">[Hardened host (optional helper)]</text><g class="message" data-participant-1="ACT" data-participant-2="HH"><polygon fill="#181818" points="2543.3887,1194.5391,2553.3887,1198.5391,2543.3887,1202.5391,2547.3887,1198.5391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1871.2979" x2="2549.3887" y1="1198.5391" y2="1198.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.3716" x="1878.2979" y="1178.3403">POST /actions/restart?svc=&lt;svc&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.645" x="1878.2979" y="1193.4731">(Authorization: API key)</text></g><g class="message" data-participant-1="HH" data-participant-2="SYS"><polygon fill="#181818" points="444.0771,1223.6719,434.0771,1227.6719,444.0771,1231.6719,440.0771,1227.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="438.0771" x2="2554.3887" y1="1227.6719" y2="1227.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.1392" x="450.0771" y="1222.606">systemctl restart &lt;svc&gt;</text></g><g class="message" data-participant-1="SYS" data-participant-2="HH"><polygon fill="#181818" points="2543.3887,1252.8047,2553.3887,1256.8047,2543.3887,1260.8047,2547.3887,1256.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="433.0771" x2="2549.3887" y1="1256.8047" y2="1256.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.064" x="440.0771" y="1251.7388">result</text></g><g class="message" data-participant-1="HH" data-participant-2="ACT"><polygon fill="#181818" points="1882.2979,1281.9375,1872.2979,1285.9375,1882.2979,1289.9375,1878.2979,1285.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1876.2979" x2="2554.3887" y1="1285.9375" y2="1285.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.064" x="1888.2979" y="1280.8716">result</text></g><g class="message" data-participant-1="ACT" data-participant-2="SYS"><polygon fill="#181818" points="444.0771,1318.0703,434.0771,1322.0703,444.0771,1326.0703,440.0771,1322.0703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="438.0771" x2="1860.2979" y1="1322.0703" y2="1322.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.3164" x="450.0771" y="1317.0044">verify health (is-active) after backoff</text></g><g class="message" data-participant-1="SYS" data-participant-2="ACT"><polygon fill="#181818" points="1849.2979,1347.2031,1859.2979,1351.2031,1849.2979,1355.2031,1853.2979,1351.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="433.0771" x2="1855.2979" y1="1351.2031" y2="1351.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.1582" x="440.0771" y="1346.1372">ActiveState=active?</text></g><g class="message" data-participant-1="ACT" data-participant-2="DB"><polygon fill="#181818" points="890.4795,1376.3359,880.4795,1380.3359,890.4795,1384.3359,886.4795,1380.3359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="884.4795" x2="1865.2979" y1="1380.3359" y2="1380.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.2881" x="896.4795" y="1375.27">INSERT actions(audit), outcomes, duration</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="2642.8525" y1="1389.3359" y2="1389.3359"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="118.3359" x="15" y="1399.5464">[DENIED/DRY_RUN]</text><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="867.4795,1420.2734,877.4795,1424.2734,867.4795,1428.2734,871.4795,1424.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="873.4795" y1="1424.2734" y2="1424.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.3813" x="592.9517" y="1419.2075">INSERT decision audit (no-op)</text></g><path d="M498.3159,1446.2734 L567.8052,1446.2734 L567.8052,1453.4063 L557.8052,1463.4063 L498.3159,1463.4063 L498.3159,1446.2734" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.5313" style="stroke:#000000;stroke-width:1.5;" width="1989.6089" x="498.3159" y="1446.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4893" x="513.3159" y="1459.3403">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120.1138" x="582.8052" y="1458.4839">[Live stream (SSE)]</text><g class="message" data-participant-1="API" data-participant-2="NGINX"><polygon fill="#181818" points="2047.0098,1480.5391,2057.0098,1484.5391,2047.0098,1488.5391,2051.0098,1484.5391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="2053.0098" y1="1484.5391" y2="1484.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.189" x="592.9517" y="1479.4731">push events &#8594; /api/stream/alerts (SSE)</text></g><g class="message" data-participant-1="NGINX" data-participant-2="UI"><polygon fill="#181818" points="2401.0049,1524.8047,2411.0049,1528.8047,2401.0049,1532.8047,2405.0049,1528.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2059.0098" x2="2407.0049" y1="1528.8047" y2="1528.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.021" x="2066.0098" y="1508.606">event: classification/action</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.1577" x="2066.0098" y="1523.7388">{id, svc, label, decision, outcome}</text></g><path d="M498.3159,1550.8047 L567.7671,1550.8047 L567.7671,1557.9375 L557.7671,1567.9375 L498.3159,1567.9375 L498.3159,1550.8047" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="1989.6089" x="498.3159" y="1550.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4512" x="513.3159" y="1563.8716">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157.9531" x="582.7671" y="1563.0151">[Public egress (optional)]</text><g class="message" data-participant-1="UI" data-participant-2="CF"><polygon fill="#181818" points="2235.9307,1585.0703,2225.9307,1589.0703,2235.9307,1593.0703,2231.9307,1589.0703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2229.9307" x2="2412.0049" y1="1589.0703" y2="1589.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.0742" x="2241.9307" y="1584.0044">https://&lt;tunnel-host&gt;/ &#8230;</text></g><g class="message" data-participant-1="CF" data-participant-2="NGINX"><polygon fill="#181818" points="2070.0098,1614.2031,2060.0098,1618.2031,2070.0098,1622.2031,2066.0098,1618.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2064.0098" x2="2223.9307" y1="1618.2031" y2="1618.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.9209" x="2076.0098" y="1613.1372">proxied HTTPS (QUIC)</text></g><g class="message" data-participant-1="NGINX" data-participant-2="API"><polygon fill="#181818" points="596.9517,1643.3359,586.9517,1647.3359,596.9517,1651.3359,592.9517,1647.3359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="590.9517" x2="2058.0098" y1="1647.3359" y2="1647.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.0063" x="602.9517" y="1642.27">upstream to Flask</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="867.4795,1694.6016,877.4795,1698.6016,867.4795,1702.6016,871.4795,1698.6016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="873.4795" y1="1698.6016" y2="1698.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.8198" x="592.9517" y="1678.4028">UPDATE incident status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.7764" x="592.9517" y="1693.5356">(resolved, MTTR, attempt_count)</text></g><g class="message" data-participant-1="DB" data-participant-2="API"><polygon fill="#181818" points="596.9517,1723.7344,586.9517,1727.7344,596.9517,1731.7344,592.9517,1727.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="590.9517" x2="878.4795" y1="1727.7344" y2="1727.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6421" x="602.9517" y="1722.6685">ack</text></g><path d="M514,1740.7344 L514,1765.7344 L1243,1765.7344 L1243,1750.7344 L1233,1740.7344 L514,1740.7344" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1233,1740.7344 L1233,1750.7344 L1243,1750.7344 L1233,1740.7344" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="708.1382" x="520" y="1757.8013">Everything persisted for audit:\nmetrics, service states, classifications,\npolicy decisions, actions, outcomes.</text><path d="M498.3159,1777.8672 L766.8359,1777.8672 L766.8359,1785 L756.8359,1795 L498.3159,1795 L498.3159,1777.8672" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="175.7969" style="stroke:#000000;stroke-width:1.5;" width="1989.6089" x="498.3159" y="1777.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.52" x="513.3159" y="1790.9341">If remediation fails repeatedly</text><g class="message" data-participant-1="ACT" data-participant-2="ACT"><line style="stroke:#181818;stroke-width:1;" x1="1866.2979" x2="1908.2979" y1="1816.1328" y2="1816.1328"/><line style="stroke:#181818;stroke-width:1;" x1="1908.2979" x2="1908.2979" y1="1816.1328" y2="1829.1328"/><line style="stroke:#181818;stroke-width:1;" x1="1867.2979" x2="1908.2979" y1="1829.1328" y2="1829.1328"/><polygon fill="#181818" points="1877.2979,1825.1328,1867.2979,1829.1328,1877.2979,1833.1328,1873.2979,1829.1328" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.7119" x="1873.2979" y="1811.0669">exponential backoff + jitter</text></g><g class="message" data-participant-1="ACT" data-participant-2="POL"><polygon fill="#181818" points="1638.4043,1854.2656,1628.4043,1858.2656,1638.4043,1862.2656,1634.4043,1858.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1632.4043" x2="1865.2979" y1="1858.2656" y2="1858.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.3936" x="1644.4043" y="1853.1997">circuitBreaker.trip?(svc)</text></g><g class="message" data-participant-1="POL" data-participant-2="ACT"><polygon fill="#181818" points="1854.2979,1883.3984,1864.2979,1887.3984,1854.2979,1891.3984,1858.2979,1887.3984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1627.4043" x2="1860.2979" y1="1887.3984" y2="1887.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.8936" x="1634.4043" y="1882.3325">trip if attempts &gt; limit in window</text></g><g class="message" data-participant-1="ACT" data-participant-2="DB"><polygon fill="#181818" points="890.4795,1912.5313,880.4795,1916.5313,890.4795,1920.5313,886.4795,1916.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="884.4795" x2="1865.2979" y1="1916.5313" y2="1916.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.834" x="896.4795" y="1911.4653">log escalation + stop automated actions</text></g><g class="message" data-participant-1="API" data-participant-2="UI"><polygon fill="#181818" points="2401.0049,1941.6641,2411.0049,1945.6641,2401.0049,1949.6641,2405.0049,1945.6641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="2407.0049" y1="1945.6641" y2="1945.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.2935" x="592.9517" y="1940.5981">SSE event: escalation_required</text></g><g class="message" data-participant-1="UI" data-participant-2="API"><polygon fill="#181818" points="596.9517,1977.7969,586.9517,1981.7969,596.9517,1985.7969,592.9517,1981.7969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="590.9517" x2="2412.0049" y1="1981.7969" y2="1981.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.9116" x="602.9517" y="1976.731">POST /api/acknowledge or /api/runbook-link</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="867.4795,2006.9297,877.4795,2010.9297,867.4795,2014.9297,871.4795,2010.9297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="585.9517" x2="873.4795" y1="2010.9297" y2="2010.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.4419" x="592.9517" y="2005.8638">record user ack / note / runbook ref</text></g><polygon fill="#FEFFDD" points="2304,2023.9297,2521,2023.9297,2531,2064.9297,2521,2106.9297,2304,2106.9297,2294,2064.9297,2304,2023.9297" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.498" x="2306" y="2039.9966">Dashboard panes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.7383" x="2306" y="2055.1294">&#8226; Current service health &amp; labels</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.9258" x="2306" y="2070.2622">&#8226; Recent incidents and actions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.4253" x="2306" y="2085.395">&#8226; SSE live ticker</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.0269" x="2306" y="2100.5278">&#8226; Audit trail &amp; MTTR trends</text><!--SRC=[bLVDRjj84hxhAGevP4b42cUo_qB6WMpBjW3PLYHviGCOC2YoPN5CTNExcxQLoG1psWTOp1FiOHzd7o9FibzrDoLHSGwhYvDcLLVLLr_zj2riAMYsJhNjNIfPMAKf6gUBcBxy-XkTbCg8l3TMggAPA9Uz2v6MXRodir8zTV3x7VMsFvhWaY8hgbHQGr6crXMqoGZzM6I2PBeMXWf9xzyRAxHGTbE9ewDuxuPEjRk1NbthR2MCrIbyIWRtGjfR2TrrJ-rzw9NfukZe5QM61kTjVRE1dNLEqMdlk3RnhKpME4vqBPDyKHkdC_jnrbOwArFpG8F9YABpMXQPqZ8EPk_heh4q6RMr9ihOUorc7yT1jl879YYS7hVbJs355Cj2Q1hA-qAAMncjHAqB0ncJB58Z0BCmiTC-6PyTcYkBR4ElQPOkXTtGEDq8ZIlI4cdfbRYbIvbIPQwUfEdIKo7nht3Pv7hSlcmgrY8l64k-8RE5Ofr5cZsevR9BZq8NoutN7PpCsxfNyFsPelbubincmmOeZkWvH7vrFhhw-s7mgiwNPQe5SgCgswXbk_EWV7BMWKDWfF-zybW1j6EDU5p8C4jvQbOBbUhSUtbpa9mBv88kH5b1CTZJIjbUfOj7JgLJkhWu8FDOW77vFZbNKbb12e20QbrOQLVDU71CnW8sYdALFGZT2nKGzpizUe6s5B47HGb3UUn5G36A70MJXdtiOVZQa8eYs84hRoYjyyA6htAR2tpWRFZZx01jf3Sjumx7nl4SHFrzZ3gNHlJ1dx8KcQKLZ2PD3NkxUvWCpgbtn5L4VVfO2xsXbgYXno8bLt_8LM5wpAz7qIMpKayqgnSpbahcw0J93M0y0nhk23bwGrgaEIMLLbatGJ5JT3AvwT9QhBkK5wZIqNNSSJdHnVtAabfo2xXIUeqUzGcdwLFZnPT__ej-Hk5BzAxFnggg4lddPGfh-UTQFaZKoI-tyhWkoXptMuqYH7M9Hy6TR97QRFKjmDx5D9BtIAkpSNhyDJZSI_eekzcSahGgaiA9Dv3ss4D6vtNhQt02e5NffbHftdU9072FMPSZwyAP46ZU9MiOahM9EsmDHk58dqPNi-5qtWIKX72uT71li0z51bWO8uo75N-aO4lCxio2Aowg9X0Gt1lXatCSlFlk7GsoJ5HMv0VW_3wc-QgG3s2JRtWRNFtKuBgFbFSQZGuN0cL8NecdOmO-yj9nnr67wSVja2MRCATC4oqoY8LMHz5_VxCnBL6LA24jofHfxvJUmosdPGkC8_GsiEFDbhGhj4wbDytrtf-BRME6vBOrivQhXdMQhLm7__BhlybpYfYxLc_kn7CcH8u39iVewcHqEhoQUqbmcJxr3FmJHmzGkBw-t7E4ExTJkXnUNaz_l9jCXxFPpNGOh9HfLO4faUPIeIEoAxI55Hg-qpaR3oQJqTLv2wL0Xf288dEGc0XzI9I6nuLS5hcGcOWxkMXXtSxf7s8w5Hb4-rGrOyZuCVHrGZ5iO5eyfcMDsw8SYWPcf-8VDLYE8j_Q3u5t0ysRwTKChxtqym3ZUvl0N9S8haJ0HQD3vtSDlT_-P9Ga8zCA-80JhtU3aLiCqB0KXfxZYmK5kCYSYIrPmlLSEfsqj3JWGOkqBZRXKuTShBioGGQcrtyRdeQ9Egi4wlQ-nf3Ie0Xl8z4wVRvZcXHYVzuoBrMDfWvO1A2M1Up0iLEzwKrh-PKXC6e4Cq01WSPE4doPtbmnkEgUb2mthjtlfvKnRAVrZp6As3AQVXk0prIbThMVL1TvY0j-X1nZAU0SFukiHeftuSOGsHhapO48umUxIclmKSgBNQDkg5GPjfWDAvExkcapsdDcklElQM5zSD-YLmMTlOdaDq3qC0eYz1wfFN9oBD7RNMxgqaRYkR3WHmuQDhE9BsNmlFCNo9-Gy9fPkXkdj7BRHSlfYujTr_VyIe8J7-333yuHf6XGsvNInISNKTzX-Y12-BZY_mh5cVIXRFMt2TgU-sY2b_vol-CX2cHuHRiv7LEwnAhUaBEpXvgxS-2a74u_U8qFkwltkqv08FBxIfT0S2n7RkBKsZTdeZr-Cbqy_nsxaq3f7UdsBs-wYj-6A9AgfofF-JR7_nJJ63vINULkAx0AkwBRK7YBR3z3l2IsDP6kANBhrDQusscvAzHcrGmpxhjkW7kL92s5vbTGqFGgqBqPkOO8dVv1BmuqkPK_5tcOywuvThS1Rd7xvONW_XpJTKF7gbwWAP7WPT6lOFixzrwWpEb9ItXlHIHsbgSW3y6LjPNf9ybxYorAb3qkWAC4ZyJ_40HFpbguQFNCNUjYFf_CAFfuCpffOU0RLrq5T946j_A-4DHVOkAd5JPfYTIw9lsQIf5gNkHUc3UE5ZUJqy5yY9ScJodqbcR3GeyqgdpaVUboFfzsARKegShUPQgMzeKrPxVlu_qsnDyDfWFiejGD5W94o1F3iQv_AyEQrJtOWBk78xTxAyCuQV8AcUsxgwcCjzzQEFyQqnacIAsnhQGoTw_nXB92PpN8lm2YU7hiGtElLLtHQDbgxRodO1KKbO2FURdPbMtJpYib0Lu1DeNgntRoKm74z4xMZ_TW-zYRVWiKgWyH-1llpoftAt-YOja0Rx2vbCKQRXSopFc3zi43J1XC1Eyrhrog0k9MhTdl1hPTQRhouceE9RPJlkC1Ke3_Bz3i- -zYkanbZM2NohsXWTWUXBuE3XTvm8A70zQzUy5ZrvtXZR5GwW5lSFdG8YNsKwLpga4EvXPIvjYLKD20mFB0g-4tdvzuUvusRrvCQMoZ_OxRAMiikypuPftr3VsrRoJ6oKpzejnKXo6GQ8iZ2p1w9JS_RBp8fpiRkCvgUNN1RLmz-0zmD3kM_Wy0]--></g></svg>